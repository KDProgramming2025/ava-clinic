# Ava Clinic (ava-clinic)

A bilingual (FA/EN) marketing site and admin dashboard for a women’s hair & eyebrow implant clinic. Built with a React + Vite frontend and a Node.js/Express + Prisma backend. Includes booking, content management, media, chat with Telegram notifications, SEO automation, and Instagram/video support.

## Tech Stack
- **Frontend**: React 18, TypeScript/JSX (Vite), Tailwind utility classes, react-router, react-helmet-async, Socket.io client, Radix UI, recharts.
- **Backend**: Node.js, Express 5, Prisma ORM (PostgreSQL), Socket.io, node-telegram-bot-api, Multer for uploads, rate limiting & security headers.
- **Build/Tooling**: Vite, npm, Prisma migrations, GitHub Actions-ready.
- **SEO**: Automatic canonicals/hreflang (fa/en), dynamic sitemaps (XML with image/video + alternates), robots.txt, JSON-LD for org/site/services/articles/videos/FAQs, OG/Twitter tags.

## Features
### Public Site
- Bilingual FA/EN with `?l=fa|en`, RTL/LTR switching, localized meta/structured data.
- Home/About/Services (list & detail)/Videos (gallery & detail)/Magazine (blog list & articles)/Contact/Booking pages.
- Responsive layouts, lazy media, video gallery with portrait/landscape handling.
- SEO automation (head tags, JSON-LD, sitemaps/robots) without manual admin input.
- Chat widget with Socket.io, history persistence in DB, Telegram admin notifications; admin replies flow back to user chat.
- Booking form with client/service selection; notifications to Telegram.
- Contact form with Telegram alerts.

### Admin Dashboard
- Authentication-protected admin shell.
- Content management: services (benefits, process steps, FAQs), testimonials, team, home/about/contact blocks, navigation/footer links, booking info cards.
- Media library uploads with alt/labels; video management (imported/hosted content with thumbnails/metadata, slugs, categories).
- Magazine/blog management (articles with authors, categories, tags, publish status).
- Clients, bookings (overlap checks, status changes, time validation), messages inbox.
- Settings: branding (logo, titles), colors, Telegram bot/chat IDs, email templates, booking flow config. (Manual SEO overrides and SEO settings page removed; SEO is fully automatic.)
- Admin users management and access control.

### Backend Services
- Express API for content, bookings, messages, media, videos, services, settings, navigation/footer, translations.
- Prisma schema for services, articles, videos, bookings, clients, messages, media, settings, navigation/footer, contact blocks/maps, translations, chat messages.
- Socket.io for real-time chat; messages saved in `ChatMessage` table with trimming.
- Telegram bot integration for chat forwarding and admin replies, plus booking/contact notifications.
- Security: CORS, JSON body limits, rate limiting, security headers; systemd service ready.
- SEO routes: `/sitemap.xml`, `/robots.txt`, `/rss.xml`, `/api/seo/jsonld` (dynamic structured data per path).

## Project Structure (high level)
- `src/` – React app (pages, components, contexts, styles).
- `server/` – Express app, routes, services, Prisma client, Telegram service, nginx configs, systemd service file.
- `prisma/` – Prisma schema and migrations.
- `public/` – Static assets (manifest, favicon logo).
- `build/` – Production build output (generated by Vite).

## Running Locally
1) Install dependencies: `npm install`
2) Set environment: create `.env` with `DATABASE_URL` (PostgreSQL) and any needed keys (Telegram bot token/chat ID, etc.).
3) Apply DB schema: `npx prisma migrate deploy` (or `prisma db push` for dev). 
4) Generate Prisma client: `npx prisma generate`.
5) Start backend: `npm run start:backend` (server listens on `:4000`).
6) Start frontend dev: `npm run dev` (Vite). For production build: `npm run build` then serve `build/` via your web server.

## Deployment Notes
- Backend is designed to run as a systemd service (`server/ava-beauty.service` sample) behind nginx (see `server/nginx.conf.example`).
- Set `SITE_URL` (or `BASE_URL`) to `https://avakasht.ir` in prod for canonical links.
- Ensure Telegram bot token/chat ID are configured in Settings or env so chat/notifications work.

## SEO & Localization Behavior
- Canonicals, hreflang, and alternates use `?l=fa` / `?l=en`; x-default included.
- Sitemaps include both language variants, images, and video metadata; robots.txt points to sitemap.
- JSON-LD covers LocalBusiness, WebSite/WebPage, Service (with FAQ), BlogPosting, VideoObject, ContactPage, AboutPage, BreadcrumbList, and FAQPage (contact/service FAQs).
- Language is also set via `?l=` query and persisted to localStorage; `<html lang>` and `dir` update accordingly.
